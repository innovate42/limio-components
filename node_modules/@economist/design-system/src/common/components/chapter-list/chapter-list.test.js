import React from 'react';
import { shallow } from 'enzyme';
import LinkWithArrow from '../link-with-arrow/link-with-arrow';
import SectionHeadline from '../section-headline/section-headline';
import ChapterList from './chapter-list';

describe('<ChapterList />', () => {
  const sectionHeadline = 'test headline';
  const sectionSubheadline = 'test subheadline';
  const chapterList = [
    { text: 'Chapter list 1', href: '/test', id: '1' },
    { text: 'Chapter list 2', href: '/', id: '2' },
  ];

  it('should render the headline', () => {
    const component = shallow(
      <ChapterList
        sectionHeadline={sectionHeadline}
        chapterList={chapterList}
      />,
    );
    expect(component.find('SectionHeadline').props().headline).toEqual(
      sectionHeadline,
    );
  });

  it('should render the subheadline if passed', () => {
    const component = shallow(
      <ChapterList
        sectionHeadline={sectionHeadline}
        sectionSubheadline={sectionSubheadline}
        chapterList={chapterList}
      />,
    );
    expect(component.find('SectionHeadline').props().subheadline).toEqual(
      sectionSubheadline,
    );
  });

  it('should render the chapter list items', () => {
    const component = shallow(
      <ChapterList
        sectionHeadline={sectionHeadline}
        chapterList={chapterList}
      />,
    );
    expect(
      component
        .find(LinkWithArrow)
        .first()
        .props().text,
    ).toEqual('Chapter list 1');
    expect(
      component
        .find(LinkWithArrow)
        .first()
        .props().href,
    ).toEqual('/test');
    expect(
      component
        .find(LinkWithArrow)
        .at(1)
        .props().text,
    ).toEqual('Chapter list 2');
    expect(
      component
        .find(LinkWithArrow)
        .at(1)
        .props().href,
    ).toEqual('/');
  });

  it('should set selected to true for the selected link', () => {
    const component = shallow(
      <ChapterList
        sectionHeadline={sectionHeadline}
        chapterList={chapterList}
        selected={1}
      />,
    );
    expect(
      component
        .find(LinkWithArrow)
        .at(1)
        .props().selected,
    ).toEqual(true);
  });

  it('should not make the section headline linkable by default', () => {
    const component = shallow(
      <ChapterList
        sectionHeadline={sectionHeadline}
        chapterList={chapterList}
        selected={1}
      />,
    );
    expect(component.find(SectionHeadline).props().href).toEqual(null);
  });

  it('should pass the given index URL to the section headline', () => {
    const url = 'www.test.com';
    const component = shallow(
      <ChapterList
        sectionHeadline={sectionHeadline}
        chapterList={chapterList}
        selected={1}
        indexUrl={url}
      />,
    );
    expect(component.find(SectionHeadline).props().href).toEqual(url);
  });
});
