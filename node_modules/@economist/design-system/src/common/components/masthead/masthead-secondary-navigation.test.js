/* eslint-disable no-magic-numbers */
import React from 'react';
import { shallow } from 'enzyme';
import MastheadSecondaryNavigation from './masthead-secondary-navigation';
import { accountData } from '../../constants';

describe('<MastheadSecondaryNavigation />', () => {
  const links = [
    { text: 'Test', href: '/test1', id: '1' },
    { text: 'Test2', href: '/test2', id: '2' },
  ];

  describe('user is logged out', () => {
    const component = shallow(
      <MastheadSecondaryNavigation
        menuIsOpen
        showLogin
        showNavToggle
        loginUrl='/'
        isLoggedIn={false}
        showAccountNav={false}
        accountData={accountData}
      />,
    );

    it('should render a link to log in if the user is logged out', () => {
      expect(component.find('.ds-masthead-nav-beta__item--log-in').length).toBe(
        1,
      );
    });
  });

  describe('user is logged in', () => {
    it('should render the correct NavigationList if passed the showLogin and isLoggedIn prop', () => {
      const component = shallow(
        <MastheadSecondaryNavigation
          menuIsOpen
          showLogin
          isLoggedIn
          showNavToggle
          accountData={accountData}
        />,
      );
      expect(component.find('NavigationList').props().type).toEqual(
        'account-logged-in',
      );
    });

    describe('account nav is hidden', () => {
      const component = shallow(
        <MastheadSecondaryNavigation
          menuIsOpen
          showLogin
          isLoggedIn
          showNavToggle
          showAccountNav={false}
          accountData={accountData}
        />,
      );

      it('should hide the NavigationList', () => {
        expect(component.find('NavigationList').length).toEqual(0);
      });

      it('should show the Log out NavigationLink', () => {
        expect(component.find('NavigationLink').props().text).toEqual(
          'Log out',
        );
      });
    });
  });

  describe('username provided', () => {
    const component = shallow(
      <MastheadSecondaryNavigation
        menuIsOpen
        isLoggedIn
        showLogin
        username='John Smith'
        showNavToggle
        accountData={accountData}
      />,
    );

    it('should pass username to the account navigation list', () => {
      expect(component.find('NavigationList').props().username).toEqual(
        'John Smith',
      );
    });
  });

  describe('masthead links', () => {
    const component = shallow(
      <MastheadSecondaryNavigation menuIsOpen links={links} />,
    );
    it('should render the correct number of masthead links if passed as a prop', () => {
      expect(
        component.find('MastheadSecondaryLinks').props().links,
      ).toHaveLength(2);
    });
  });
});
